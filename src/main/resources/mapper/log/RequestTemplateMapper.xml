<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ml.timi.mapper.log.RequestTemplateMapper">

    <resultMap type="com.ml.timi.model.log.request.RequestTemplate" id="RequestTemplateMap">
        <result property="batchId" column="batch_id" jdbcType="VARCHAR"/>
        <result property="module" column="module" jdbcType="VARCHAR"/>
        <result property="requestStatus" column="request_status" jdbcType="VARCHAR"/>
        <result property="requestStatusMessage" column="request_status_message" jdbcType="VARCHAR"/>
        <result property="requestTime" column="request_time" jdbcType="TIMESTAMP"/>
        <result property="requestBodyCount" column="request_body_count" jdbcType="INTEGER"/>
        <result property="requestBody" column="request_body" jdbcType="VARCHAR"/>
        <result property="id" column="id" jdbcType="INTEGER"/>
    </resultMap>

    <sql id="Log_Base_Column_List">
        batch_id, module, request_status, request_status_message, request_time,request_body_count, request_body
    </sql>

    <!--新增RequestTemplate(request)所有列-->
    <insert id="insertRequestTemplate" keyProperty="id" useGeneratedKeys="true">
        insert into request_template_web
        (<include refid="Log_Base_Column_List"/>)
        values
        (#{batchId}, #{module}, #{requestStatus}, #{requestStatusMessage}, #{requestTime}, #{requestBodyCount},
        #{requestBody})

    </insert>

    <!-- &lt;!&ndash;查询单个&ndash;&gt;
     <select id="queryById" resultMap="RequestTemplateMap">
         select batchId,
                module,
                request_status,
                request_status_message,
                request_time,
                request_count,
                request_body,
                response_time,
                response_status,
                response_status_message,
                response_count,
                response_success_count,
                response_error_count,
                response_body,
                id
         from timi.request_template
         where id = #{id}
     </select>

     &lt;!&ndash;查询指定行数据&ndash;&gt;
     <select id="queryAllByLimit" resultMap="RequestTemplateMap">
         select batchId,
                module,
                request_status,
                request_status_message,
                request_time,
                request_count,
                request_body,
                response_time,
                response_status,
                response_status_message,
                response_count,
                response_success_count,
                response_error_count,
                response_body,
                id
         from timi.request_template
         limit #{offset}, #{limit}
     </select>

     &lt;!&ndash;通过实体作为筛选条件查询&ndash;&gt;
     <select id="queryAll" resultMap="RequestTemplateMap">
         select
         batchId, module, request_status, request_status_message, request_time, request_count, request_body,
         response_time, response_status, response_status_message, response_count, response_success_count,
         response_error_count, response_body, id
         from timi.request_template
         <where>
             <if test="batchid != null and batchid != ''">
                 and batchId = #{batchid}
             </if>
             <if test="module != null and module != ''">
                 and module = #{module}
             </if>
             <if test="requestStatus != null and requestStatus != ''">
                 and request_status = #{requestStatus}
             </if>
             <if test="requestStatusMessage != null and requestStatusMessage != ''">
                 and request_status_message = #{requestStatusMessage}
             </if>
             <if test="requestTime != null">
                 and request_time = #{requestTime}
             </if>
             <if test="requestCount != null">
                 and request_count = #{requestCount}
             </if>
             <if test="requestBody != null and requestBody != ''">
                 and request_body = #{requestBody}
             </if>
             <if test="responseTime != null">
                 and response_time = #{responseTime}
             </if>
             <if test="responseStatus != null and responseStatus != ''">
                 and response_status = #{responseStatus}
             </if>
             <if test="responseStatusMessage != null and responseStatusMessage != ''">
                 and response_status_message = #{responseStatusMessage}
             </if>
             <if test="responseCount != null">
                 and response_count = #{responseCount}
             </if>
             <if test="responseSuccessCount != null">
                 and response_success_count = #{responseSuccessCount}
             </if>
             <if test="responseErrorCount != null">
                 and response_error_count = #{responseErrorCount}
             </if>
             <if test="responseBody != null and responseBody != ''">
                 and response_body = #{responseBody}
             </if>
             <if test="id != null">
                 and id = #{id}
             </if>
         </where>
     </select>

     &lt;!&ndash;新增所有列&ndash;&gt;
     <insert id="insert" keyProperty="id" useGeneratedKeys="true">
         insert into timi.request_template(batchId, module, request_status, request_status_message, request_time,
                                           request_count, request_body, response_time, response_status,
                                           response_status_message, response_count, response_success_count,
                                           response_error_count, response_body)
         values (#{batchid}, #{module}, #{requestStatus}, #{requestStatusMessage}, #{requestTime}, #{requestCount},
                 #{requestBody}, #{responseTime}, #{responseStatus}, #{responseStatusMessage}, #{responseCount},
                 #{responseSuccessCount}, #{responseErrorCount}, #{responseBody})
     </insert>

     <insert id="insertBatch" keyProperty="id" useGeneratedKeys="true">
         insert into timi.request_template(batchId, module, request_status, request_status_message, request_time,
         request_count, request_body, response_time, response_status, response_status_message, response_count,
         response_success_count, response_error_count, response_body)
         values
         <foreach collection="entities" item="entity" separator=",">
             (#{entity.batchid}, #{entity.module}, #{entity.requestStatus}, #{entity.requestStatusMessage},
             #{entity.requestTime}, #{entity.requestCount}, #{entity.requestBody}, #{entity.responseTime},
             #{entity.responseStatus}, #{entity.responseStatusMessage}, #{entity.responseCount},
             #{entity.responseSuccessCount}, #{entity.responseErrorCount}, #{entity.responseBody})
         </foreach>
     </insert>

     <insert id="insertOrUpdateBatch" keyProperty="id" useGeneratedKeys="true">
         insert into timi.request_template(batchId, module, request_status, request_status_message, request_time,
         request_count, request_body, response_time, response_status, response_status_message, response_count,
         response_success_count, response_error_count, response_body)
         values
         <foreach collection="entities" item="entity" separator=",">
             (#{entity.batchid}, #{entity.module}, #{entity.requestStatus}, #{entity.requestStatusMessage},
             #{entity.requestTime}, #{entity.requestCount}, #{entity.requestBody}, #{entity.responseTime},
             #{entity.responseStatus}, #{entity.responseStatusMessage}, #{entity.responseCount},
             #{entity.responseSuccessCount}, #{entity.responseErrorCount}, #{entity.responseBody})
         </foreach>
         on duplicate key update
         batchId = values(batchId) , module = values(module) , request_status = values(request_status) ,
         request_status_message = values(request_status_message) , request_time = values(request_time) , request_count =
         values(request_count) , request_body = values(request_body) , response_time = values(response_time) ,
         response_status = values(response_status) , response_status_message = values(response_status_message) ,
         response_count = values(response_count) , response_success_count = values(response_success_count) ,
         response_error_count = values(response_error_count) , response_body = values(response_body)
     </insert>

     &lt;!&ndash;通过主键修改数据&ndash;&gt;
     <update id="update">
         update timi.request_template
         <set>
             <if test="batchid != null and batchid != ''">
                 batchId = #{batchid},
             </if>
             <if test="module != null and module != ''">
                 module = #{module},
             </if>
             <if test="requestStatus != null and requestStatus != ''">
                 request_status = #{requestStatus},
             </if>
             <if test="requestStatusMessage != null and requestStatusMessage != ''">
                 request_status_message = #{requestStatusMessage},
             </if>
             <if test="requestTime != null">
                 request_time = #{requestTime},
             </if>
             <if test="requestCount != null">
                 request_count = #{requestCount},
             </if>
             <if test="requestBody != null and requestBody != ''">
                 request_body = #{requestBody},
             </if>
             <if test="responseTime != null">
                 response_time = #{responseTime},
             </if>
             <if test="responseStatus != null and responseStatus != ''">
                 response_status = #{responseStatus},
             </if>
             <if test="responseStatusMessage != null and responseStatusMessage != ''">
                 response_status_message = #{responseStatusMessage},
             </if>
             <if test="responseCount != null">
                 response_count = #{responseCount},
             </if>
             <if test="responseSuccessCount != null">
                 response_success_count = #{responseSuccessCount},
             </if>
             <if test="responseErrorCount != null">
                 response_error_count = #{responseErrorCount},
             </if>
             <if test="responseBody != null and responseBody != ''">
                 response_body = #{responseBody},
             </if>
         </set>
         where id = #{id}
     </update>

     &lt;!&ndash;通过主键删除&ndash;&gt;
     <delete id="deleteById">
         delete
         from timi.request_template
         where id = #{id}
     </delete>-->

</mapper>

